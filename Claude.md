## 🌐 応答言語

このプロジェクトでは、**すべての応答を日本語で行ってください**。コメント、ドキュメント、エラーメッセージ、説明文など、ユーザーとのコミュニケーションはすべて日本語を使用します。

## 📚 ドキュメント自動更新システム

このプロジェクトでは、開発中に得られた知識を体系的に管理し、既存ドキュメントに反映させるシステムを採用しています。

### 参照すべきドキュメント

作業開始時に必ず以下のドキュメントを確認してください：

- `TASK.md` - タスク管理と進捗追跡
- `PROJECT_PLAN.md` - プロジェクト計画とアーキテクチャ設計
- `docs/SCREEN_LIST.md` - 画面一覧
- `docs/patterns.md` - 実装パターンとベストプラクティス
- `docs/troubleshooting.md` - トラブルシューティングガイド
- `docs/dependencies.md` - 依存関係とAPI使用例
- `docs/setup-log.md` - ドキュメント自動更新システム設定ログ
- `deploy/README.md` - デプロイ関連

### 更新ルール

#### 提案タイミング
以下の状況で、ドキュメント更新を提案してください：

1. **エラーや問題を解決した時**
2. **効率的な実装パターンを発見した時**
3. **新しいAPI/ライブラリの使用方法を確立した時**
4. **既存ドキュメントの情報が古い/不正確だと判明した時**
5. **頻繁に参照される情報を発見した時**
6. **コードレビューの修正を終わらせた時**

#### 提案フォーマット
💡 ドキュメント更新の提案： [状況の説明]
【更新内容】 [具体的な追加/修正内容]
【更新候補】
[ファイルパス1] - [理由]
[ファイルパス2] - [理由]
新規ファイル作成 - [理由]
どこに追加しますか？（番号を選択 or skip）

#### 承認プロセス
1. ユーザーが更新先を選択
2. 実際の更新内容をプレビュー表示
3. ユーザーが最終承認（yes/edit/no）
4. 承認後、ファイルを更新

### 既存ドキュメントとの連携

- 既存の記載形式やスタイルを踏襲すること
- 関連する既存内容がある場合は参照を明記すること
- 日付（YYYY-MM-DD形式）を含めて更新履歴を残すこと

### 重要な制約

1. **ユーザーの承認なしにファイルを更新しない**
2. **既存の内容を削除・変更せず、追加のみ行う**
3. **機密情報（APIキー、パスワード等）は記録しない**
4. **プロジェクトの慣習やスタイルガイドに従う**

### ドキュメントの分割管理

CLAUDE.mdが肥大化することを防ぐため、以下の基準で適切にファイルを分割してください：

- **100行を超えた場合**: 関連する内容を別ファイルに分離することを提案
- **推奨される分割方法**:
  - `docs/update-system.md` - システム更新のルール
  - `docs/project-specific.md` - プロジェクト固有の設定
  - `docs/references.md` - 参照すべきドキュメントのリスト
- **CLAUDE.mdには概要とリンクのみ残す**: 詳細は個別ファイルへ

## 🚀 デプロイコマンド

Herokuへのデプロイは以下のコマンドで実行します：

```bash
make deploy
```

このコマンドは以下の処理を自動的に実行します：
1. Heroku CLIの確認とログイン
2. 未コミットの変更を自動コミット
3. Herokuへのプッシュ
4. データベースマイグレーション
5. アプリケーションの再起動
6. ヘルスチェック

初回デプロイの場合は、先に以下を実行してください：
```bash
./deploy-scripts/initial-deploy.sh
```

## ✅ コード品質チェック

コードを修正・追加した後は、**必ず以下のチェックを実行してください**：

### 1. Lint チェック
```bash
npm run lint
```
エラーが出た場合は、自動修正を試みてください：
```bash
npm run lint -- --fix
# または
npx eslint . --fix
npx prettier --write .
```

### 2. ビルドチェック
```bash
npm run build
```
TypeScriptのコンパイルエラーや、Next.jsのビルドエラーがないことを確認します。

### 3. テスト実行
```bash
npm test
```
すべてのテストが成功することを確認します。

### 重要な注意事項
- **コミット前に必ずこれらのチェックをすべて実行**してください
- エラーが残っている状態でコミットしないでください
- 自動修正できないエラーは手動で修正してください
- CIでの失敗を防ぐため、ローカルでの確認を徹底してください
